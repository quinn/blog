<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.45 'Alegreya',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Alegreya',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.75);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.775);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.8);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}ul{margin-left:1.45rem;margin-right:0;margin-top:0.725rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:0.85rem;line-height:1.45rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}blockquote{margin-left:0;margin-right:1.45rem;margin-top:0;padding-bottom:0;padding-left:0.99687rem;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.65);font-style:italic;border-left:0.45313rem solid hsla(0,0%,0%,0.5);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.45rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.45rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}li > ul{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.45rem / 2);}code{font-size:0.85rem;line-height:1.45rem;}kbd{font-size:0.85rem;line-height:1.45rem;}samp{font-size:0.85rem;line-height:1.45rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.725rem;padding-bottom:calc(0.725rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h1,h2,h3,h4,h5,h6{line-height:1;}h1,h2,h3,h4{line-height:1;margin-top:1.45rem;margin-bottom:0.725rem;}h4,h5,h6{text-transformation:uppercase;}a{color:hsl(230,55%,58%);text-decoration:none;}a:hover,a:active{box-shadow:0 1px 0 0 currentColor;}blockquote > :last-child{margin-bottom:0;}@media only screen and (max-width:480px){html{font-size:112.5%;}blockquote{border-left:0.27187rem solid hsla(0,0%,0%,0.5);margin-left:-1.0875rem;margin-right:0;padding-left:0.81563rem;}}a.gatsby-resp-image-link{box-shadow:none;}code[class*="language-"], pre[class*="language-"]{font-size:0.75rem !important;}.gatsby-highlight{margin-bottom:1.45rem;}</style><style data-href="/styles.6d82a24cc2891ca3975f.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 4.1.0"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" title="Your Site&#x27;s RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=ba5aa8a0303a57342488002c0b77539d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=ba5aa8a0303a57342488002c0b77539d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=ba5aa8a0303a57342488002c0b77539d"/><title data-react-helmet="true">Facilitating Bidirectional Cross-Domain Communication with an Iframe | Quinn&#x27;s Blog</title><meta data-react-helmet="true" name="description" content="Using iframes in your app can be excruciating, especially when the iframe and the parent window are on two different domains. I&#x27;m going to go over the process of facilitating bi-directional communication between the iframe and it&#x27;s parent window.
"/><meta data-react-helmet="true" property="og:title" content="Facilitating Bidirectional Cross-Domain Communication with an Iframe"/><meta data-react-helmet="true" property="og:description" content="Using iframes in your app can be excruciating, especially when the iframe and the parent window are on two different domains. I&#x27;m going to go over the process of facilitating bi-directional communication between the iframe and it&#x27;s parent window.
"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Quinn Shanahan"/><meta data-react-helmet="true" name="twitter:title" content="Facilitating Bidirectional Cross-Domain Communication with an Iframe"/><meta data-react-helmet="true" name="twitter:description" content="Using iframes in your app can be excruciating, especially when the iframe and the parent window are on two different domains. I&#x27;m going to go over the process of facilitating bi-directional communication between the iframe and it&#x27;s parent window.
"/><link href="//fonts.googleapis.com/css?family=Alegreya+Sans:500|Alegreya:400,400i,700,700i" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/webpack-runtime-fa180a91d2f6225472d3.js"/><link as="script" rel="preload" href="/framework-07eca8f1d232a1009bf6.js"/><link as="script" rel="preload" href="/app-48201a757ac287e9940c.js"/><link as="script" rel="preload" href="/commons-bd1b7c2ab7ce4539e1e0.js"/><link as="script" rel="preload" href="/cd7d5f864fc9e15ed8adef086269b0aeff617554-27c5c7b037ab879c42cc.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-0d1117399e862026c218.js"/><link as="fetch" rel="preload" href="/page-data/2014/08-12-iframe-communication/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1091219763.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:43.5rem;padding:2.175rem 1.0875rem"><header><h3 style="margin-top:0"><a href="/">Quinn&#x27;s Blog</a></h3></header><main><article><header><h1 style="margin-top:1.45rem;margin-bottom:0">Facilitating Bidirectional Cross-Domain Communication with an Iframe</h1><p style="font-size:0.87055rem;line-height:1.45rem;display:block;margin-bottom:1.45rem">August 12, 2014</p></header><section><p>I recently was working on a project where iframes seemed to be the most
logical solution. Actually, iframes I think are a perfectly reasonable tool
for some problems, but unfortunately the get a bad name because of their many
edge cases. I originally set out to create bi-directional event-based
communination between the iframe and it’s parent, cross-browser, and
regardless of same or different origin (domain). Here I’m going to describe
the javascript I’m using as well as some of the backend code required to work
around certain browsers.</p>
<blockquote>
<p><strong>Note</strong>: The below examples use jQuery.</p>
</blockquote>
<h3>Window Message Events</h3>
<p>The key to all of this is the <code class="language-text">window.postMessage</code> call and the <code class="language-text">message</code> event. Here are some snippets:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">window<span class="token punctuation">.</span>top<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'message text'</span><span class="token punctuation">,</span> <span class="token string">'http://tastehoneyco.com'</span><span class="token punctuation">)</span>

<span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> message <span class="token operator">=</span> e<span class="token punctuation">.</span>originalEvent<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token comment">// do something with the message.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>This is a pretty minimal and easy to understand API. In my case, it seemed helpful to be able to send more complex messages, so I created a shared javascript file across the two domains that knows how to serialize and deserialize JSON messages containing named events. This allows for a more automated workflow:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">
<span class="token comment">// IframeMessages.prototype.iframe is an object that contains</span>
<span class="token comment">// all of the events for the iframe. This code is used by the iframe.</span>
<span class="token class-name">IframeMessages</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>wrapper<span class="token punctuation">.</span><span class="token function-variable function">activityFinished</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// this code is ran by the parent window.</span>
<span class="token keyword">var</span> iframe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IframeMessages</span><span class="token punctuation">;</span>
iframe<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token string">'activityFinished'</span><span class="token punctuation">,</span> activity<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3>Common use-case: Make my iframe the height of the iframe content!</h3>
<p>This is probably the most common use-case for something like this. I’ve looked
into this quite a bit, and I am fairly confident there is no way to handle
this without polling the dimensions. Also, the child iframe <strong>must</strong> send the
dimensions because the parent is unable to introspect on the iframe (on a
different domain). See the following snippet:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// turn on resize detection. Begins polling quill.org with content dimensions</span>
<span class="token comment">// of module.</span>
<span class="token class-name">IframeMessages</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">autoResize</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// no wrapper, we are not in an iframe. Early exit.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>self <span class="token operator">==</span> window<span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token comment">// modified from: http://stackoverflow.com/a/14901150/1397097</span>
  <span class="token keyword">function</span> <span class="token function">checkDocumentHeight</span> <span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> lastHeight <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">,</span> newHeight<span class="token punctuation">;</span>

    <span class="token comment">// there doesn't seem to be a reliable way to detected wh</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      newHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>lastHeight <span class="token operator">!=</span> newHeight<span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      lastHeight <span class="token operator">=</span> newHeight<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// send the dimensions to quill.org.</span>
  <span class="token keyword">function</span> <span class="token function">postWindowSize</span> <span class="token punctuation">(</span><span class="token parameter">first</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token operator">==</span> <span class="token string">'first'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>height <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">checkDocumentHeight</span><span class="token punctuation">(</span><span class="token function">postWindowSize</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">postWindowSize</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'first'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>and the resize event triggered on the parent:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// this is the handler for the resize event coming from the iframe.</span>
<span class="token comment">// it contains the new dimensions of the content contained from within the iframe.</span>
<span class="token function-variable function">resize</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">dimensions</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$iframe<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>dimensions<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<h3>Getting cookies to work</h3>
<blockquote>
<p><strong>Note (2014-08-13)</strong>: Newer versions of Chrome and other browsers seem to</p>
</blockquote>
<p>block 3rd party cookies by default. I am still working on a workaround for
this.</p>
<p>If you’ve done this before on a different domain, you’ve probably noticed that
there are some issues cookies. Safari (and possibly other browsers) blocks
iframes on domains that the user hasn’t visited from storing cookies. This
actually makes sense from a security / privacy perspective in most scenarios
(you wouldn’t want an advertisement on a domain you’ve never visited to be
able to store cookies) but in our case it is very inconvenient. There is no
“hack” per se to get around this other than to actually navigate to the page
and then navigate back.</p>
<h3>Using postMessage with different domains</h3>
<p>First, it is important that all frames are ready before attempting to use
<code class="language-text">postMessage</code>. To get postMessage to work you must match the frame’s host
<em>exactly</em> to get it work:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">targetWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span>       <span class="token string">'http://locahost:3000'</span><span class="token punctuation">)</span>
targetWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'other message'</span><span class="token punctuation">,</span> <span class="token string">'https://example.com'</span><span class="token punctuation">)</span></code></pre></div>
<p>That’s it for now! I’ll post more tips and tricks later on when I’ve come up
with more.</p></section><hr style="margin-bottom:1.45rem"/><footer><p><a href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fquinn.io%2F2014%2F08-12-iframe-communication%2F" target="_blank" rel="noopener noreferrer">Discuss on Twitter</a> • <a href="https://github.com/quinn/blog/tree/master/content/blog//2014/08-12-iframe-communication//index.md" target="_blank" rel="noopener noreferrer">View on GitHub</a></p><hr style="margin-bottom:1.45rem"/><div style="display:flex;margin-bottom:3.625rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.725rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECBQP/xAAXAQEBAQEAAAAAAAAAAAAAAAACAAED/9oADAMBAAIQAxAAAAEyuBWsLJkHWgj/AP/EABsQAAIDAAMAAAAAAAAAAAAAAAECAAMREiEx/9oACAEBAAEFArnZAG2cRLrWYliSluJPY/Z//8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAQ/9oACAEDAQE/AWN//8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAQ/9oACAECAQE/ASd//8QAHBAAAgICAwAAAAAAAAAAAAAAAREAEBIhMUFR/9oACAEBAAY/AhiV1BNgxcDyhk3WwK//xAAcEAADAAIDAQAAAAAAAAAAAAAAAREhMVFhcbH/2gAIAQEAAT8ha9rdMxD+iY3l0olRpihWPGQKrHA96V8FNw10YF4P/9oADAMBAAIAAwAAABDQwD//xAAZEQADAAMAAAAAAAAAAAAAAAAAAREQMVH/2gAIAQMBAT8QhVE8w9n/xAAYEQACAwAAAAAAAAAAAAAAAAAAARAhMf/aAAgBAgEBPxC0lh//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFRYZGh/9oACAEBAAE/EGr0YdiPqLaiuRyXsiyizS1AuH3sdszibwm4mwCvfzGIV7VaFm0sYU3CJGcfrP/Z" alt="Quinn Shanahan" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/23971e2c7e6e460d7ec2556a73d79eec/93bd4/profile-pic.jpg 1x,
/static/23971e2c7e6e460d7ec2556a73d79eec/9d3fa/profile-pic.jpg 1.5x,
/static/23971e2c7e6e460d7ec2556a73d79eec/c2440/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/23971e2c7e6e460d7ec2556a73d79eec/93bd4/profile-pic.jpg 1x,
/static/23971e2c7e6e460d7ec2556a73d79eec/9d3fa/profile-pic.jpg 1.5x,
/static/23971e2c7e6e460d7ec2556a73d79eec/c2440/profile-pic.jpg 2x" src="/static/23971e2c7e6e460d7ec2556a73d79eec/93bd4/profile-pic.jpg" alt="Quinn Shanahan" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Quinn Shanahan</strong> who lives and works in NYC<br/><a href="https://twitter.com/quinnshanahan">Twitter</a> | <a href="https://github.com/quinn">Github</a> | <a href="https://instagram.com/qshan">Instagram</a></p></div></footer></article><nav><ul style="display:flex;flex-wrap:nowrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/2014/04-19-log-nginx-to-stdout-and-stderr-when-run/">← <!-- -->Log to STDOUT and STDERR when Running NGINX in the Foreground</a></li><li><a rel="next" href="/2014/08-17-installing-metasploit-on-osx-with-rbenv/">Installing Metasploit on OS X with rbenv<!-- --> →</a></li></ul></nav></main><footer><div style="float:right"><a href="/rss.xml" target="_blank" rel="noopener noreferrer">rss</a></div>© <!-- -->2021<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-157532376-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2014/08-12-iframe-communication/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-eda371cea4b37a3ecbfd.js"],"app":["/app-48201a757ac287e9940c.js"],"component---src-pages-404-js":["/component---src-pages-404-js-9409a7ffd28f0cb3922f.js"],"component---src-pages-index-js":["/component---src-pages-index-js-e2058424a3d3d5e19721.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-0d1117399e862026c218.js"]};/*]]>*/</script><script src="/polyfill-eda371cea4b37a3ecbfd.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-0d1117399e862026c218.js" async=""></script><script src="/cd7d5f864fc9e15ed8adef086269b0aeff617554-27c5c7b037ab879c42cc.js" async=""></script><script src="/commons-bd1b7c2ab7ce4539e1e0.js" async=""></script><script src="/app-48201a757ac287e9940c.js" async=""></script><script src="/framework-07eca8f1d232a1009bf6.js" async=""></script><script src="/webpack-runtime-fa180a91d2f6225472d3.js" async=""></script></body></html>