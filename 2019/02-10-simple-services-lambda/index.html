<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:125%/1.45 'Alegreya',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Alegreya',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.75);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.775);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.8);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.9);font-family:'Alegreya Sans',sans-serif;font-weight:500;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}ul{margin-left:1.45rem;margin-right:0;margin-top:0.725rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.45rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:0.85rem;line-height:1.45rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}blockquote{margin-left:0;margin-right:1.45rem;margin-top:0;padding-bottom:0;padding-left:0.99687rem;padding-right:0;padding-top:0;margin-bottom:1.45rem;color:hsla(0,0%,0%,0.65);font-style:italic;border-left:0.45313rem solid hsla(0,0%,0%,0.5);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.45rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.45rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.45rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}li > ul{margin-left:1.45rem;margin-bottom:calc(1.45rem / 2);margin-top:calc(1.45rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.45rem / 2);}code{font-size:0.85rem;line-height:1.45rem;}kbd{font-size:0.85rem;line-height:1.45rem;}samp{font-size:0.85rem;line-height:1.45rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:0.96667rem;padding-right:0.96667rem;padding-top:0.725rem;padding-bottom:calc(0.725rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h1,h2,h3,h4,h5,h6{line-height:1;}h1,h2,h3,h4{line-height:1;margin-top:1.45rem;margin-bottom:0.725rem;}h4,h5,h6{text-transformation:uppercase;}a{color:hsl(230,55%,58%);text-decoration:none;}a:hover,a:active{box-shadow:0 1px 0 0 currentColor;}blockquote > :last-child{margin-bottom:0;}@media only screen and (max-width:480px){html{font-size:112.5%;}blockquote{border-left:0.27187rem solid hsla(0,0%,0%,0.5);margin-left:-1.0875rem;margin-right:0;padding-left:0.81563rem;}}a.gatsby-resp-image-link{box-shadow:none;}code[class*="language-"], pre[class*="language-"]{font-size:0.75rem !important;}.gatsby-highlight{margin-bottom:1.45rem;}</style><meta data-react-helmet="true" name="description" content="Functional demo can be found here: GitHub — quinn/lambda-nodejs-example Here’s a process for creating simple backends for a web client app. Use cases would be…"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=edf3d310d67f8284a562bc3a58c3e761"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=edf3d310d67f8284a562bc3a58c3e761"/><title data-react-helmet="true">Create simple services for web clients using API Gateway, CloudFormation, and Lambda | Quinn&#x27;s Blog</title><meta name="generator" content="Gatsby 2.19.7"/><meta data-react-helmet="true" property="og:title" content="Create simple services for web clients using API Gateway, CloudFormation, and Lambda"/><meta data-react-helmet="true" property="og:description" content="Functional demo can be found here: GitHub — quinn/lambda-nodejs-example Here’s a process for creating simple backends for a web client app. Use cases would be…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Quinn Shanahan"/><meta data-react-helmet="true" name="twitter:title" content="Create simple services for web clients using API Gateway, CloudFormation, and Lambda"/><meta data-react-helmet="true" name="twitter:description" content="Functional demo can be found here: GitHub — quinn/lambda-nodejs-example Here’s a process for creating simple backends for a web client app. Use cases would be…"/><style data-href="/styles.493e6315ef3a09bc2f74.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><link href="//fonts.googleapis.com/css?family=Alegreya+Sans:500|Alegreya:400,400i,700,700i" rel="stylesheet" type="text/css"/><link rel="alternate" type="application/rss+xml" title="Dan Abramov&#x27;s Overreacted Blog RSS Feed" href="/rss.xml"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-06edd4d3db3f9517a8dc.js"/><link as="script" rel="preload" href="/commons-e0ab5437313eaadf34d8.js"/><link as="script" rel="preload" href="/app-46f88f7794bfc4662713.js"/><link as="script" rel="preload" href="/styles-5b24e9d901ec094b02ef.js"/><link as="script" rel="preload" href="/webpack-runtime-54aa9decc7c8169fd2b9.js"/><link as="fetch" rel="preload" href="/page-data/2019/02-10-simple-services-lambda/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:43.5rem;padding:2.175rem 1.0875rem"><header><h3 style="margin-top:0"><a href="/">Quinn&#x27;s Blog</a></h3></header><main><article><header><h1 style="margin-top:1.45rem;margin-bottom:0">Create simple services for web clients using API Gateway, CloudFormation, and Lambda</h1><p style="font-size:0.87055rem;line-height:1.45rem;display:block;margin-bottom:1.45rem">February 10, 2019</p></header><section><p><em>Functional demo can be found here: <a href="https://github.com/quinn/lambda-nodejs-example">GitHub — quinn/lambda-nodejs-example</a></em></p>
<p>Here’s a process for creating simple backends for a web client app. Use cases would be when you would like to add a small piece of functionality that doesn’t have much interaction with the rest of the app, but don’t want the overhead that comes with standing up a server.</p>
<h2>API Gateway Models</h2>
<p>A lot of articles on this topic using <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-model.html">AWS API Gateway Models</a>. This is probably helpful if you are building a full-sized REST API around well defined resources, which wasn’t really my use case (small, independent/unrelated behavior). I’m interested in learning more about this but (for now) I’ll probably continue using ruby / node / python app server on VPS (e.g. EC2) for this type of thing.</p>
<h2>CloudFormation</h2>
<p>Since using Lambda was new to me I wanted to make sure I could easily replicate the process so I decided to use CloudFormation to preserve the configuration and make it easy to replicate. It sucks figuring out something in the AWS console and then not really remembering the exact steps to recreate it. CloudFormation isn’t the only way to get this working, but it helped me a lot while learning the ins-and-outs of Lambda + API Gateway.</p>
<h2>Application Structure</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/c6e28/diagram.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 72.14406302757456%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAABiUlEQVQoz42ROXPcMAyF9f/bFG7yC9ylzSRNXGfijOONd3L6kLXiHiRFkQAJHiElSyt77HHevIKS8IECXqVFzX6fO/AxUAz+GceYUnLect5CB+QpTapsf5DtH77bBwfBYiSM3gWHkyEO1SF6g5q1TPUqP44dqxTIKAIlHWAK2EvU8pDPM597zdWzJjjG9nZ9/vEEeorWbf7++vLhDfT2yc1j9dziAQ6ONjVbX6wMN8HY5oatLy/7rY7+P24OhB6t40gaAqA1uhMikk/epoxlR58eKw4qcCRLoIFzZ7CcUe9YI/lW7EczyQ/dIKWUFKKX6rjt3Gd7P81M5T+9BQd6ck8WvfdEBPk9BiWUIxfIeqQqOceu765W31DDCJc5yR49zLwX7N2nk6bebe5ZfXtdv3+rm21VSp31lpbxPM65wILtv69XQigpRdM0Nz+vjNFlYWPRc+Rx21mqM5zn2eUcW4btS9gy53K5OCC4ZWZlYa87Jeh4e3aqFS3jrtKrGmDVyR9fP6PWyy//ADDGK9BwOr0DAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Diagram"
        title="Diagram"
        src="/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/fcda8/diagram.png"
        srcset="/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/12f09/diagram.png 148w,
/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/e4a3f/diagram.png 295w,
/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/fcda8/diagram.png 590w,
/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/efc66/diagram.png 885w,
/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/c83ae/diagram.png 1180w,
/static/724dd7f7c52a1ebf4b0ea1f75c1602fd/c6e28/diagram.png 1777w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
<small><center>
<em>Diagram of CloudFormation Template generated by <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/working-with-templates-cfn-designer.html">Designer</a></em></p>
</center></small>
<p>This configuration creates the simplest possible setup that I could figure out for a web client. There are two routes:</p>
<ul>
<li>
<p><code class="language-text">POST /</code>: This is connected to the lambda function. API Gateway passes information about
the request as arguments to the lambda function. The function returns an object which
contains information on how the http response should be structured, e.g:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
   body: &quot;Content for the HTTP Body&quot;,
   statusCode: 200, // or any other status code
   headers: {
       &quot;Content-Type&quot;: &quot;text/plain&quot;,
       // etc, more headers
   },
}</code></pre></div>
</li>
<li><code class="language-text">OPTIONS /</code>: The second route is on the same path but receives on an OPTIONS request. It
simply responds with the most permissive CORS possible. In a larger app, you could
configure your own CORS API handler to do something more sophisticated, e.g. returning the
appropriate headers to enforce a whitelist of allowed domains.</li>
</ul>
<p>Here is the resource definition that attaches API Gateway to Lambda:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">"apiGatewayRootMethod"</span><span class="token punctuation">:</span>
  <span class="token key atrule">Type</span><span class="token punctuation">:</span> AWS<span class="token punctuation">:</span><span class="token punctuation">:</span>ApiGateway<span class="token punctuation">:</span><span class="token punctuation">:</span>Method
  <span class="token key atrule">Properties</span><span class="token punctuation">:</span>
    <span class="token key atrule">AuthorizationType</span><span class="token punctuation">:</span> NONE
    <span class="token key atrule">HttpMethod</span><span class="token punctuation">:</span> POST
    <span class="token key atrule">ResourceId</span><span class="token punctuation">:</span> <span class="token tag">!GetAtt</span> <span class="token string">"restApi.RootResourceId"</span>
    <span class="token key atrule">RestApiId</span><span class="token punctuation">:</span> <span class="token tag">!Ref</span> <span class="token string">"restApi"</span>
    <span class="token key atrule">Integration</span><span class="token punctuation">:</span>
      <span class="token key atrule">IntegrationHttpMethod</span><span class="token punctuation">:</span> <span class="token string">"POST"</span>
      <span class="token key atrule">Type</span><span class="token punctuation">:</span> <span class="token string">"AWS_PROXY"</span>
      <span class="token key atrule">Uri</span><span class="token punctuation">:</span> <span class="token tag">!Sub</span>
        <span class="token punctuation">-</span> <span class="token string">"arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${lambdaArn}/invocations"</span>
        <span class="token punctuation">-</span> <span class="token key atrule">lambdaArn</span><span class="token punctuation">:</span> <span class="token tag">!GetAtt</span> <span class="token string">"lambdaFunction.Arn"</span></code></pre></div>
<p>In the above resource it is referencing a Lambda function resource named lambdaFunction. See the last line where this reference is created. And the other major piece, the resource definition for the Lambda function:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">"lambdaFunction"</span><span class="token punctuation">:</span>
  <span class="token key atrule">Type</span><span class="token punctuation">:</span> <span class="token string">"AWS::Lambda::Function"</span>
  <span class="token key atrule">Properties</span><span class="token punctuation">:</span>
    <span class="token key atrule">Code</span><span class="token punctuation">:</span>
      <span class="token key atrule">S3Bucket</span><span class="token punctuation">:</span> <span class="token tag">!Ref</span> bucketName
      <span class="token key atrule">S3Key</span><span class="token punctuation">:</span> <span class="token tag">!Ref</span> bucketKey
    <span class="token key atrule">FunctionName</span><span class="token punctuation">:</span> <span class="token tag">!Ref</span> <span class="token string">"lambdaFunctionName"</span>
    <span class="token key atrule">Handler</span><span class="token punctuation">:</span> index.handler
    <span class="token key atrule">MemorySize</span><span class="token punctuation">:</span> <span class="token number">128</span>
    <span class="token key atrule">Role</span><span class="token punctuation">:</span> <span class="token tag">!GetAtt</span> <span class="token string">"lambdaIAMRole.Arn"</span>
    <span class="token key atrule">Runtime</span><span class="token punctuation">:</span> nodejs8.10
    <span class="token key atrule">Timeout</span><span class="token punctuation">:</span> <span class="token number">10</span></code></pre></div>
<p>This simply takes as parameters the bucket name and bucket key and loads the zip file located there. Nodejs package managers load all dependencies relative to the project (in <code class="language-text">node_modules</code>) it is very straightforward to create a standalone bundle. See the repo for an example of how to do this.</p>
<h2>Caveats</h2>
<p>The main caveat that I found was that CloudFormation only <em>updates configuration</em>. So, certain things may require manual intervention after the stack has been deployed. Updates to the lambda function code seem to be available immediately. However, API Gateway has it’s own “deploy” process which must be ran for any changes to the API Gateway. Typically, changes will probably be with the function code rather than the API structure, so this doesn’t seem like a huge inconvenience. Ideally I’d like to figure out a way to automate this as well.</p>
<hr>
<p>This is a “beginner” post, so let me know if what you think and if I missed anything!</p></section><hr style="margin-bottom:1.45rem"/><footer><p><a href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fquinn.io%2F2019%2F02-10-simple-services-lambda%2F" target="_blank" rel="noopener noreferrer">Discuss on Twitter</a> • <a href="https://github.com/quinn/blog/tree/master/content/blog//2019/02-10-simple-services-lambda//index.md" target="_blank" rel="noopener noreferrer">View on GitHub</a></p><hr style="margin-bottom:1.45rem"/><div style="display:flex;margin-bottom:3.625rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.725rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECBQP/xAAXAQEBAQEAAAAAAAAAAAAAAAACAAED/9oADAMBAAIQAxAAAAEyuBWsLJkHWgj/AP/EABoQAAIDAQEAAAAAAAAAAAAAAAECAAMRMRL/2gAIAQEAAQUCudkAbZ5EutZiWJKW4k7H7//EABYRAQEBAAAAAAAAAAAAAAAAABEAEP/aAAgBAwEBPwFjf//EABYRAQEBAAAAAAAAAAAAAAAAABEAEP/aAAgBAgEBPwEnf//EAB0QAQABAwUAAAAAAAAAAAAAAAERABAhAhIxQVH/2gAIAQEABj8CHQx1RWRqODyxumbZC3//xAAdEAADAAICAwAAAAAAAAAAAAAAAREhMVFxQWGx/9oACAEBAAE/Ia+LdMdB/SjeTSiVHkVCx0yBVY4HvSvQpumvRkl4P//aAAwDAQACAAMAAAAQ0MA//8QAGREAAwADAAAAAAAAAAAAAAAAAAEREDFR/9oACAEDAQE/EIVRPMPZ/8QAGBEAAgMAAAAAAAAAAAAAAAAAACEBEDH/2gAIAQIBAT8QYSow/8QAHRABAAIDAAMBAAAAAAAAAAAAAQARITFRQWGRof/aAAgBAQABPxByFGHYj8mEqulsvSD3KdLUC4eTp1lxlvhNxdgNe/uMQr2oULA1pGFNwjRx+s//2Q==" alt="Quinn Shanahan" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/23971e2c7e6e460d7ec2556a73d79eec/93bd4/profile-pic.jpg 1x,
/static/23971e2c7e6e460d7ec2556a73d79eec/9d3fa/profile-pic.jpg 1.5x,
/static/23971e2c7e6e460d7ec2556a73d79eec/c2440/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/23971e2c7e6e460d7ec2556a73d79eec/93bd4/profile-pic.jpg 1x,
/static/23971e2c7e6e460d7ec2556a73d79eec/9d3fa/profile-pic.jpg 1.5x,
/static/23971e2c7e6e460d7ec2556a73d79eec/c2440/profile-pic.jpg 2x" src="/static/23971e2c7e6e460d7ec2556a73d79eec/93bd4/profile-pic.jpg" alt="Quinn Shanahan" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Quinn Shanahan</strong> who lives and works in NYC<br/><a href="https://twitter.com/quinnshanahan">Twitter</a> | <a href="https://github.com/quinn">Github</a> | <a href="https://instagram.com/qshan">Instagram</a></p></div></footer></article><nav><ul style="display:flex;flex-wrap:nowrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/2017/12-06-setting-up-docker-compose-for-development/">← <!-- -->Setting up Docker Compose for Development</a></li><li><a rel="next" href="/2020/02-02-gatsby-and-gh-pages/">Create a Blog With Github Pages and Gatsby<!-- --> →</a></li></ul></nav></main><footer><div style="float:right"><a href="/rss.xml" target="_blank" rel="noopener noreferrer">rss</a></div>© <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-157532376-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2019/02-10-simple-services-lambda/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-46f88f7794bfc4662713.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-06edd4d3db3f9517a8dc.js"],"component---src-pages-404-js":["/component---src-pages-404-js-a2f8b45d223d87b6d480.js"],"component---src-pages-index-js":["/component---src-pages-index-js-fbcba1dde563790cc3e0.js"]};/*]]>*/</script><script src="/webpack-runtime-54aa9decc7c8169fd2b9.js" async=""></script><script src="/styles-5b24e9d901ec094b02ef.js" async=""></script><script src="/app-46f88f7794bfc4662713.js" async=""></script><script src="/commons-e0ab5437313eaadf34d8.js" async=""></script><script src="/component---src-templates-blog-post-js-06edd4d3db3f9517a8dc.js" async=""></script></body></html>