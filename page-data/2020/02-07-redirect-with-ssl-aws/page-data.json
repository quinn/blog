{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/02-07-redirect-with-ssl-aws/","result":{"data":{"site":{"id":"Site","siteMetadata":{"title":"Quinn's Blog"}},"markdownRemark":{"id":"8a10cb0a-6690-51a5-9d52-9c8754e20057","excerpt":"All I wanted to do was redirect quinnshanahan.com to quinn.io. Simple, right? Simple enough to not require a server, right? As simple as this would be using aâ€¦","html":"<p>All I wanted to do was redirect quinnshanahan.com to quinn.io. Simple, right? Simple enough to not require a server, <em>right</em>?</p>\n<p>As simple as this would be using a droplet or an existing host I have running with nginx, or even a lambda function I really wanted to do this without any host of any kind. I thought this should be possible on AWS, and it was, but very convoluted.</p>\n<p>The main thing that makes this work is a feature for S3 that allows you to redirect a bucket to any other domain. The config looks like this in the console:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cbbbce30fbefdbc3e471c2a82441c386/8c557/static-web-hosting.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAC0ElEQVQ4y5WUS08UQRDH51N5NRqN0ZuPRA++MIKcvfoZvHtxjRDBqFEENFw8+gjKI4TFqCzssLDuzM7Ou3uePX+re3dwWVkDnfzSPd1d/6mqqRrtS8NFZcXA1Fob0xsWptbbqCy18Jh4smzsrys91D4xSTYTPSZXDdo3MLdhQnv4uYkTlR84+2wTZ6ZruPCmjpH5Hdyd03Hl1RZuv9XV+sZMXXFnVse119s4+fQnTk10OU2cm6phbOYXtEfLLZx/XlPGV8nw+sIu7i00MD6v4+bMNkZpb/ydjpHZOgnXMUr7Y8TFFzVc6uPyyy3cf1+DpjsMaybHuhGi2maoWhFWWhyLuyGWfzN8a4ZY3AtpZlhqMjV/pecVOpOs0t11sl8zIlSbLrQiT4EiR8sw0bEdWCyDyXK4sUCYFoSAR+sgEYgzAZbk8OO/RHReDpHG0OIkQSYKGEGChs2gWz6aToiAcfAoImJwzuGxSAlwEmCEtCmKAoLI5ZoEGd3TEhKkE+VlxEjIcxH4HlzXhe95Cs+x0WwTQQqbZ2hTFGleKK+kqESOiBzQRJaiw1J80l2wwIfVseGSiN3pQHcitLmAxXMEaYHBUYodEMzSBBHlZs+LEUccQRCAMabwQkZ5y1V4WS+skkHhfUGZw3JIkZCQOZOHLAyR51nXCyEgDuEfD5OeoNySoZpmWx3Iy3lO3mWUr5TIDiFNFeU4KEhvUaGSd2KIN+I/Xh4uSGL8mIJDQ5bDcVyVQ1Wk0kDWWC6OH7I0lrmStWdRuTg0245DL3AQ0odRBTzUy25hy37hnATTNNn3KI5jEmDqTTL0soSOOpKYBCNSbW1Z8DwfHnWI9Mj3fSU2WGdFf81R7co2lB3zcSfAwqYP22fQOPWsXm2SQKhE+gX7k14iim5pG9SG3+kvY1GXPfjQwC361dVMD1pI/ctjpoQGkcLDkBGpmXBcDw49y2/wB17uk5mBqL5YAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Static Website S3 Properties\"\n        title=\"Static Website S3 Properties\"\n        src=\"/static/cbbbce30fbefdbc3e471c2a82441c386/fcda8/static-web-hosting.png\"\n        srcset=\"/static/cbbbce30fbefdbc3e471c2a82441c386/12f09/static-web-hosting.png 148w,\n/static/cbbbce30fbefdbc3e471c2a82441c386/e4a3f/static-web-hosting.png 295w,\n/static/cbbbce30fbefdbc3e471c2a82441c386/fcda8/static-web-hosting.png 590w,\n/static/cbbbce30fbefdbc3e471c2a82441c386/8c557/static-web-hosting.png 700w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Thats pretty straightforward. Now all you have to do is create a bucket with a name matching the hostname that you want to redirect from and you are good to go. You may notice here the bucket name is <code class=\"language-text\">redirect.quinnshanahan.com</code>. The reason for this is that it is not possible to attach an SSL certificate to a bucket, and instead you must create an SSL certificate and attach it to a Cloudfront distribution. The latter half of <a href=\"https://medium.com/@channaly/how-to-host-static-website-with-https-using-amazon-s3-251434490c59\">This blog post</a> describes the process well. The main difference is that instead of associating the distribution with the S3 bucket I associated it with the domain <code class=\"language-text\">redirect.quinnshanahan.com</code>. This allows cloudfront to receive the <code class=\"language-text\">301</code> from the static website hosting rather than the <code class=\"language-text\">403</code> from the bucket.</p>\n<p>The final step is to tie everything together in Route 53 using aliases.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 471px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a21698ef6e3000ffbc71fcebc12c081/1f09d/redirect-config.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.92781316348195%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3klEQVQoz2VSiXKbMBT0//9Uj8lM6kmbjtPGtWPHgGxukMAggbi2T7KT4JaZnZXE02qfVosoP+MY5ojzCmFaWj6rEaUa/sFoUcgepRz+g6h7KD1gwfwEm72LV9fH7sDAghR1O102qp7EB1QNCSmNotGQGvb/DfSEirgxgpznODIPjVJI0wSF4KjOJYpCgOeZnZ/LErXk5IDj8k0z/hiPIwnmeQ7GGLquh5QSnHOLJElQ1TUVjeiHgZg2DJOda63Rtu1FZpoIFx6obmFEjCgmU9iiriWqqiKHBZSSVDjakw0Gy3RA31vMv3fBMIrxa/WIH9sMPzcBRJbAcRm1n0OIAlnGkeW3yC3EezecC2uq6zosjKMoDBHEHCc/gutzOKGCF0uwWH0gmXFi/iscqM603jQtXZeyrheKwnBd1wbiHPbYMW6TbLqRUqPkuivexvq6TgjEYFu9admcIISwIaRpSpyCFzWOQQLvGOFEzE4RjUOIUkE2A2p6TpXqoNreBmTu1cAKmr49z8N6vcbz829sty94ePLw+dsWX5c7fFm+4NP9xvL9o4vl6oi776+4e9hj+eRj9ed0DW4maNyZp+M4DoIgoDfXwITlByEhQkyuoyixa2EY20C0NkmPlucO/wIaFUaxNgYx+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Route 53 config for redirect.quinnshanahan.com\"\n        title=\"Route 53 config for redirect.quinnshanahan.com\"\n        src=\"/static/8a21698ef6e3000ffbc71fcebc12c081/1f09d/redirect-config.png\"\n        srcset=\"/static/8a21698ef6e3000ffbc71fcebc12c081/12f09/redirect-config.png 148w,\n/static/8a21698ef6e3000ffbc71fcebc12c081/e4a3f/redirect-config.png 295w,\n/static/8a21698ef6e3000ffbc71fcebc12c081/1f09d/redirect-config.png 471w\"\n        sizes=\"(max-width: 471px) 100vw, 471px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 478px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33caa5dfd266f32662a798d2416fe5f0/50978/cloudfront-config.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.48117154811716%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACF0lEQVQ4y3WT6W6bUBCF/f7P1SY/ErmV0tbEBrNjdriXfT2duTZOKqdIRyNAfHfOnGEnqhZhKhBlEhHVtGxQdfNddbdSXf559pVkO2OaF+yCKMW74cCwfJxMF7YfQ9BLliRQ3nQQ3UgfbeCvtCrgOM3YCVHCdRxUUqLrWkghkGcppBRo6hpVk2KYalyvFf+/VizLwkABh4BN0xCwQ1EUyPIcSZIQVGJdgJmszPOsxB/1/YBhGK6Y9XrIst6ADIrjWMH6vkfNXVUSZVmgpXfrwpAP8f00jQSfVFcMXG+wW4cS2uE33o4BXrQUeRrDcnx4QYwkEwjj/EFRUihlWYE8Z+VgpwrIHUVRhEsYIwhCmF4KO+4RZB2pxyUf7nUT33tJD5c0jQN6ss/u7pbDMFQz8z0Huh0hr2ld2hGyGSHqHlU7oZAtMlqpsqKxdJNalaicyO5yneFynfOubVvVrud58H2fxDWAYZh4P55gWjYOB42CKlA3Ldquv4W0qhkyhGe4hbbjVrk7TdOg67oSJ23bNkzTVAdxTdOUgiopsEp1sy3RA5DT5aFuMP44CHwCWjidjnBdhw470H6Wn9L9tH1k+QGYZRlZNHA+n1VnSVpAPzs4GRZM28dRtyj5AD4lL2iWkufaDKrW9Cdt1u+W2eIG44B+/nHxtLfw/INl4/XXBS9vPr69Gnim5097U+n73sbxfFGdTtMV+Bewed9tcT0WUAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Route 53 config for cloudfront\"\n        title=\"Route 53 config for cloudfront\"\n        src=\"/static/33caa5dfd266f32662a798d2416fe5f0/50978/cloudfront-config.png\"\n        srcset=\"/static/33caa5dfd266f32662a798d2416fe5f0/12f09/cloudfront-config.png 148w,\n/static/33caa5dfd266f32662a798d2416fe5f0/e4a3f/cloudfront-config.png 295w,\n/static/33caa5dfd266f32662a798d2416fe5f0/50978/cloudfront-config.png 478w\"\n        sizes=\"(max-width: 478px) 100vw, 478px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>I did the same thing for <code class=\"language-text\">www</code>.</p>\n<p>Adding SSL to the redirect domain probably made things overly complicated, and arguably not necessary. Since my browser has cached that I had SSL on <code class=\"language-text\">quinnshanahan.com</code> it was probably mostly for myself than anyone else.</p>\n<hr>\n<p>References:<br />\n<a href=\"https://medium.com/@channaly/how-to-host-static-website-with-https-using-amazon-s3-251434490c59\">How to host static website with https using amazon s3</a><br />\n<a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/redirect-domain-route-53/\">Redirect a Domain to Another Domain using Route 53</a></p>","frontmatter":{"title":"Setup serverless redirects on AWS with SSL and Route 53","date":"February 07, 2020","description":null}}},"pageContext":{"slug":"/2020/02-07-redirect-with-ssl-aws/","previous":{"fields":{"slug":"/2020/02-02-gatsby-and-gh-pages/"},"frontmatter":{"title":"Create a Blog With Github Pages and Gatsby"}},"next":null}}}