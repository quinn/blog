{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/02-07-redirect-with-ssl-aws/","result":{"data":{"site":{"siteMetadata":{"title":"Quinn's Blog"}},"markdownRemark":{"id":"d3e1ca2f-8b24-519e-9c40-87ae445bc9a7","excerpt":"All I wanted to do was redirect quinnshanahan.com to quinn.io. Simple, right? Simple enough to not require a server, right? As simple as this would be using aâ€¦","html":"<p>All I wanted to do was redirect quinnshanahan.com to quinn.io. Simple, right? Simple enough to not require a server, <em>right</em>?</p>\n<p>As simple as this would be using a droplet or an existing host I have running with nginx, or even a lambda function I really wanted to do this without any host of any kind. I thought this should be possible on AWS, and it was, but very convoluted.</p>\n<p>The main thing that makes this work is a feature for S3 that allows you to redirect a bucket to any other domain. The config looks like this in the console:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cbbbce30fbefdbc3e471c2a82441c386/8c557/static-web-hosting.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 93.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2ElEQVQ4y5WT24sURxjF+5/yNWiSB0HIW9RA0IjRsJJ/IOTRvyCbQETMQxaSQNhFN3sBg29CvBAiLkaZ3Z1xJuPuXHqmr1XVl+run1T19rq7GVf84PBVV3cfzvnqlHOv7TH/aMDNf0bceupy88mY+Ye7zD/Y5YdHg/319w8HFubZ9B8fv8GNxwO+ezBgcWOIc/3+Did+avHxL1t89FubM7e7fLn2H1dWeny62OHySo+rqz0u3OlycbnLldUe55de8sHPm5xa2OTkwiYfLmxy+tc215a3cOb/HvLJ7x0+u93l8/U+l/58xdzdPnNrPb5Y7loys778R0321R7OLnY4t9Th3GKNs0sv+eZuB2c3TNj2ErYngrYn2fZTnrsJG0PJc1fxbKTYGCqejRX/juu+MVK8cBOL1iSh46VsexntUYhDoTHYGYxwvYCR0AyFJkhLRF4R5xVhVq8TXSKygjAtiNK6p7qkKZ0mOFmWo8sKV+bseIL+JGToxwgpkUqhVIKSEj+WlkDmNWlRVpakqiq7Nk/mHyfLc7MLpUZJgYhC4igiDEOiyCAiDHwG01q9n2imSlsRDaGBKaVUbXkQZfzVDZBxyGTqEQQh0+mUrp/iqpKJqi0frYbsEKHWuZ2NKzISpYiFQBq7UhIJSV6UlAdsNThKvE+YZdn+CzMDIYR9kSSJJS2KgqoqKcvZ+J/C3MyQeox+EDB2XUtmPjZkWmvyXJPrGchz25s6RGhsGUUN2SFU1Wwcr7AmNJuNuqJ4u9V3Wjbl+b7dtIr3lBnS97Zc2p9yfN9nMpngeZ6NzdTz7CFVe/beptBk0twX49DGplFkTlwlCWmaWjQzPRgNZsSmKRM7RwnFTmtEGIQEQUAUxTbYYRRxXNVXsLQZXt8KWHoR4EUCR8aSV62hVSP2Qh3HYj+Ds22W9na1XMU4zvj2Xp+v13v03QDHnmxakx2FucfHIT7QRWzufMBrBXGTh+wMrvkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Static Website S3 Properties\"\n        title=\"Static Website S3 Properties\"\n        src=\"/static/cbbbce30fbefdbc3e471c2a82441c386/fcda8/static-web-hosting.png\"\n        srcset=\"/static/cbbbce30fbefdbc3e471c2a82441c386/12f09/static-web-hosting.png 148w,\n/static/cbbbce30fbefdbc3e471c2a82441c386/e4a3f/static-web-hosting.png 295w,\n/static/cbbbce30fbefdbc3e471c2a82441c386/fcda8/static-web-hosting.png 590w,\n/static/cbbbce30fbefdbc3e471c2a82441c386/8c557/static-web-hosting.png 700w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Thats pretty straightforward. Now all you have to do is create a bucket with a name matching the hostname that you want to redirect from and you are good to go. You may notice here the bucket name is <code class=\"language-text\">redirect.quinnshanahan.com</code>. The reason for this is that it is not possible to attach an SSL certificate to a bucket, and instead you must create an SSL certificate and attach it to a Cloudfront distribution. The latter half of <a href=\"https://medium.com/@channaly/how-to-host-static-website-with-https-using-amazon-s3-251434490c59\">This blog post</a> describes the process well. The main difference is that instead of associating the distribution with the S3 bucket I associated it with the domain <code class=\"language-text\">redirect.quinnshanahan.com</code>. This allows cloudfront to receive the <code class=\"language-text\">301</code> from the static website hosting rather than the <code class=\"language-text\">403</code> from the bucket.</p>\n<p>The final step is to tie everything together in Route 53 using aliases.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 471px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8a21698ef6e3000ffbc71fcebc12c081/1f09d/redirect-config.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4UlEQVQoz2WSiWrcMBCG8/4vVZqWJmlLDxJIasebXW+8vg/5kGzJ9lckLzlawccvhtHPzGguorTCkpYdp6ymEIpWLQg5v6OVC2KYaQbj9F/q3qDNwoX/dMTfhQT7CC8IScuWblxpBo2QhlbOdGqhlop2NAwT9OO6MW3YmM1xhkl8wqKUJE1iuq5FiAbR1JRFTtNU9G1HO2ToWfL+rGesLCzLwkUUnUiSBGNm2rajLCtHlueocXRJ8zzbfOZ5e6SUQhuz+ayrs7RxZyiEwGJf2Cr7vqfrOpqmYZomVpc4O1Or9pHW2unb82IYBAF3t7dcPwj+PIZUZc7uaU9dC8qypigqivI9Nm6pqsphO6rrejO0F9vyc1IRnWJ2Ucs+GTikkvAt2aseM8kulkS5RE8jUimklK+Gh8OBPEvw/cAZTQbktKCmFaXPnO82PuoVIRcysfzf8jAMlGVJlmWOoqzJq5YwSjkcY6I4Zx+eeD7ltP3IoAy91HRSM05mm/O6YozZDG2pnudxf//A3d0tnr/n8/eAyxufj9ceH288Pny559O3R65+Hrj5feTyq8/Vjyeufz3zuE9dhS+GdgWiKCIMQ+wH2QGLtucUJ26mVrOsIE7SMxmN6NwSG7Mwae12cduChb9nCUbVSzqzNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Route 53 config for redirect.quinnshanahan.com\"\n        title=\"Route 53 config for redirect.quinnshanahan.com\"\n        src=\"/static/8a21698ef6e3000ffbc71fcebc12c081/1f09d/redirect-config.png\"\n        srcset=\"/static/8a21698ef6e3000ffbc71fcebc12c081/12f09/redirect-config.png 148w,\n/static/8a21698ef6e3000ffbc71fcebc12c081/e4a3f/redirect-config.png 295w,\n/static/8a21698ef6e3000ffbc71fcebc12c081/1f09d/redirect-config.png 471w\"\n        sizes=\"(max-width: 471px) 100vw, 471px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 478px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33caa5dfd266f32662a798d2416fe5f0/50978/cloudfront-config.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACJUlEQVQ4y32TC2+bMBRG8///1rRNU9dN06omDXkQEiA8bMA8DMHkTDYt6yZtlo4+IeDg63tZqUaTCEUqFalQ5GVDrc1Coydqh/kvqjOMZmIVp4KXfcDOv+AdzvjnhKo1VJ1B6QnZasruRq3v7trK1Sv1kndUNzGMhlVVVZzPAVVV0vcaVVVIIVCqpG0a6lbQ3xTzuvPvdWeaplkYBGfquqbve4qiREhJluXYe9N0x5gJY4zDvjQMA30/zJr73X3GphO2bUuWZXRd5x5s7K5qRVkWtG3DNJk/uE+GcbxhxvG38FXmhErVvGyeedpe+LKWiCwhOMecw4RcKq6pJMn+pnAIUVDIAikLyrJyFazsjtI0Jb6mhNEV/5LhXzVRrgnznkjMxGIglgORGIjynkuuCVLNzZbvjqCfhbbkJEmcNAoDPD9G1Iamu6HaG1UzUHcjhdKIsqWsexo90mjDtRhdmXbZXIRKKcIwJAyjJfcHn5etx9EPeF6/kOWSpu1ou97N22jms3tr1FvTVlprhBBsNhv2+z2e5yGlJAgCjscj4eXi0jbOjpadhsmYZVis5K0pi7AsS3a7ncO+HIUhQXDC2265nAM2mzVFIV13Le/n8X2HF2FRFG53h8OB0+lElhcc7J+z8/GDkO3uiB9EhHGKqjV1O9C0w2vqpfRFaAfYCn3f5xrH/Fhf+Pjo8/n7zNeniIefIR8ednz6dpx5tHli7YVL6Vb4C4Rn31ZxCVsMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Route 53 config for cloudfront\"\n        title=\"Route 53 config for cloudfront\"\n        src=\"/static/33caa5dfd266f32662a798d2416fe5f0/50978/cloudfront-config.png\"\n        srcset=\"/static/33caa5dfd266f32662a798d2416fe5f0/12f09/cloudfront-config.png 148w,\n/static/33caa5dfd266f32662a798d2416fe5f0/e4a3f/cloudfront-config.png 295w,\n/static/33caa5dfd266f32662a798d2416fe5f0/50978/cloudfront-config.png 478w\"\n        sizes=\"(max-width: 478px) 100vw, 478px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I did the same thing for <code class=\"language-text\">www</code>.</p>\n<p>Adding SSL to the redirect domain probably made things overly complicated, and arguably not necessary. Since my browser has cached that I had SSL on <code class=\"language-text\">quinnshanahan.com</code> it was probably mostly for myself than anyone else.</p>\n<hr>\n<p>References:<br />\n<a href=\"https://medium.com/@channaly/how-to-host-static-website-with-https-using-amazon-s3-251434490c59\">How to host static website with https using amazon s3</a><br />\n<a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/redirect-domain-route-53/\">Redirect a Domain to Another Domain using Route 53</a></p>","fields":{"slug":"/2020/02-07-redirect-with-ssl-aws/"},"frontmatter":{"title":"Setup serverless redirects on AWS with SSL and Route 53","date":"February 07, 2020","description":null}}},"pageContext":{"slug":"/2020/02-07-redirect-with-ssl-aws/","previous":{"fields":{"slug":"/2020/02-02-gatsby-and-gh-pages/"},"frontmatter":{"title":"Create a Blog With Github Pages and Gatsby"}},"next":{"fields":{"slug":"/2021/11-20-compiler-lexer/"},"frontmatter":{"title":"Writing a C Compiler: Part 1, Lexer"}}}},"staticQueryHashes":["1091219763","63159454"]}